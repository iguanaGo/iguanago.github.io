"use strict";angular.module("iguanagoApp",["ngAnimate","ngCookies","ngResource","ui.router","ngSanitize","ngTouch","Tabletop"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("main",{url:"/",templateUrl:"views/landing.html",controller:"LandingCtrl"}).state("flights",{url:"/flights",templateUrl:"views/flights.html",controller:"FlightsCtrl"}).state("destinations",{url:"/destinations",templateUrl:"views/destinations.html",controller:"DestinationsCtrl"})}]),angular.module("iguanagoApp").controller("FlightsCtrl",["$scope","flightService",function(a,b){a.viewMode="fl-vm-view-grid",a.viewSelected="grid",a.getSelected=function(b){switch(b){case a.viewSelected:return"fl-vm-selected";default:return""}},b.getFlights().then(function(b){a.flights=b[0]})}]),angular.module("iguanagoApp").controller("LandingCtrl",["$scope","$state",function(a,b){a.goToDestinations=function(){b.go("destinations")}}]),angular.module("iguanagoApp").service("flightService",["$http","$q",function(a,b){function c(){var a=b.defer();return window.Tabletop.init({key:"https://docs.google.com/spreadsheets/d/1MNkEoLahoi_6bjwi0QkU9-SkYirnI_13jaH63k2Ogok/pubhtml?gid=0&single=true",simpleSheet:!0,callback:function(b,c){a.resolve([b,c])}}),a.promise}return{getFlights:function(){return c()}}}]),angular.module("iguanagoApp").controller("DestinationsCtrl",["$scope",function(a){function b(a){}var c=960,d=500,e=d3.select("#world-map").append("svg").attr("width","100%").attr("height",d),f=e.append("g").attr("class","countries"),g=e.append("g").attr("class","arcs"),h=(e.append("g").attr("class","points"),d3.geo.miller().scale(153).translate([c/2,d/1.5])),i=d3.geo.path().projection(h);d3.json("../resources/world.json",function(a,c){if(a)return console.error(a);f.selectAll(".countries").data(topojson.feature(c,c.objects.countries).features).enter().append("path").attr("class",function(a){return"country "+a.id}).attr("d",i).on("click",b);var d=function(a){a.transition().duration(4e3).attrTween("stroke-dasharray",e).each("end",function(a,b){})},e=function(){var a=this.getTotalLength(),b=d3.interpolateString("0,"+a,a+","+a);return function(a){return b(a)}},h=[{type:"LineString",coordinates:[[-58.381667,-34.603333],[-3.716667,40.383333]]},{type:"LineString",coordinates:[[-58.381667,-34.603333],[13.383333,52.516667]]},{type:"LineString",coordinates:[[-58.381667,-34.603333],[-74.00597,40.71427]]}],j=g.selectAll(".arc").data(h);j.enter().append("path").attr({"class":"arc"}),j.attr({d:i}).call(d),j.exit().remove()})}]);